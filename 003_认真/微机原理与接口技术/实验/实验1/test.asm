PORT_IN EQU 280H
PORT_OUT EQU 282H
PORT_CTL EQU 283H

CODE SEGMENT
ASSUME CS:CODE
START:
	MOV DX, PORT_CTL
	MOV AL, 10010000B
	OUT DX, AL

	MOV DX, PORT_OUT
	MOV AL, 00010000B
	OUT DX, AL
	MOV CX, 2000H
CYCLE:
	;控制
	MOV DX, PORT_IN
	MOV BL, AL ;暂存寄存器状态
	IN 	AL, DX
	TEST AL, 10000000B
	MOV AL, BL ;放回寄存器原状态
	JZ ELES
	JNZ MAIN1

ELES:
	MOV BL, AL ;暂存寄存器状态
	IN  AL, DX
	TEST AL, 01000000B
	MOV AL, BL ;放回寄存器原状态
	JZ CYCLE
	JNZ MAIN2

MAIN1:
	MOV DX, PORT_OUT
	OUT DX, AL
	ROR AL, 1
	MOV BX, 2000H
	DELAY1:
		MOV AH, 0FFH
		DELAY_HEY1:
			DEC AH
			JNZ DELAY_HEY1
		DEC BX
		JNZ DELAY1
	DEC CX
	JNZ CYCLE

MAIN2:
	MOV DX, PORT_OUT
	OUT DX, AL
	ROL AL, 1
	MOV BX, 2000H
	DELAY2:
		MOV AH, 0FFH
		DELAY_HEY2:
			DEC AH
			JNZ DELAY_HEY2
		DEC BX
		JNZ DELAY2
	DEC CX
	JNZ CYCLE

CODE ENDS
END START